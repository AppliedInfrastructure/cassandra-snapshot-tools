# Cassandra Snapshot Tools
A handy couple of scripts that make creating, moving, and restoring SSTable snapshots between clusters easy.  Some common use cases include:
* Copying keyspaces between clusters (QA environments, for example)
* Staging an upgrade (application, Cassandra, both) using a copy of live data
* Seeding data in a test environment
* Snapshotting a keyspace for offline analytics
* Backup and restore
* Generally moving a keyspace from one Cassandra cluster to another

Cassandra Snapshot Tools currently includes two BASH shell scripts, `getSnapshot` and `putSnapshot`, which leverage standard Cassandra utilities like `nodetool`, `cqlsh`, and `sstableloader` to simplify the process of creating snapshots and moving them between hosts.  A convenient compressed tar archive is generated by `getSnapshot`, and includes all of the SSTable snapshot files, metadata, and schema information necessary to restore the keyspace into another Cassandra cluster (or the same cluster).  The `putSnapshot` tool is then used to alter various attributes of the original snapshot, and restore into the destination Cassandra cluster.

### Features
* Automatically generates a keyspace snapshot and packages into an easy-to-move archive
* Copies snapshots out of the Cassandra data directory, allowing space to be reclaimed using `nodetool clearsnapshot`
* Archive a previously created snapshot (e.g. created manually using `nodetool snapshot`)
* Schedulable using Cron (e.g. for scheduled backups)
* Change keyspace name, datacenter name and replication factor on restore
* Restore to local or remote clusters, either privately hosted or through hosted services like [Datascale.io](http://datascale.io)
* Easy to use with sane defaults
* Most Cassandra versions supported (detailed list coming soon)

### Basic Usage Examples
1. Copy a keyspace to the same Cassandra cluster using a different keyspace name:
    ```sh
    $ getSnapshot -k <keyspace_name>
    $ putSnapshot -f <snapshot package file> -k <new keyspace name>
    ```
2. Copy a keyspace to a remote Cassandra cluster using the same keyspace name:
    ```sh
    $ getSnapshot -k <keyspace_name>
    $ putSnapshot -f <snapshot package file> -n <destination node IP>
    ```
3. Copy a keyspace from a Cassandra cluster to a single-node instance using a different keyspace name:
    ```sh
    $ getSnapshot -k <keyspace_name>
    $ putSnapshot -f <snapshot package file> -n <destination node IP> -k <new keyspace name> -r 1
    ```

### Caveats
* Partitioner configuration (e.g. RandomPartitioner, Murmur3Partitioner, etc.) must be the same between source and destination Cassandra clusters.
* Local access to the source Cassandra node is required (to create/collect snapshot files).  Fairly open network access is required to the destination Cassandra node (to create the schema and load SSTables).

### Contributing
All contributions welcome!  Please see [How to Contribute](CONTRIBUTING.md).
